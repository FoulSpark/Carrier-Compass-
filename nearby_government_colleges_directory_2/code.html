<html><head>
<link crossorigin="" href="https://fonts.gstatic.com/" rel="preconnect"/>
<link as="style" href="https://fonts.googleapis.com/css2?display=swap&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900&amp;family=Plus+Jakarta+Sans%3Awght%40400%3B500%3B700%3B800" onload="this.rel='stylesheet'" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
<title>Carrier Compass</title>
<link href="data:image/x-icon;base64," rel="icon" type="image/x-icon"/>
<meta charset="utf-8"/>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<style type="text/tailwindcss">
    :root {
      --background: #111827;
      --foreground: #F9FAFB;
      --card: #1F2937;
      --card-foreground: #F9FAFB;
      --popover: #1F2937;
      --popover-foreground: #F9FAFB;
      --primary: #3B82F6;
      --primary-foreground: #F9FAFB;
      --secondary: #374151;
      --secondary-foreground: #F9FAFB;
      --muted: #374151;
      --muted-foreground: #9CA3AF;
      --accent: #374151;
      --accent-foreground: #F9FAFB;
      --destructive: #EF4444;
      --destructive-foreground: #F9FAFB;
      --border: #374151;
      --input: #374151;
      --ring: #3B82F6;
    }
  </style>
</head>
<body class="bg-[var(--background)] text-[var(--foreground)]">
<div class="relative flex size-full min-h-screen flex-col group/design-root overflow-x-hidden" style='font-family: "Plus Jakarta Sans", "Noto Sans", sans-serif;'>
<!-- Loading overlay -->
<div id="loadingOverlay" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
  <div class="bg-white p-6 rounded-lg text-center">
    <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"></div>
    <p class="text-gray-700">Searching for colleges...</p>
  </div>
</div>
<div class="layout-container flex h-full grow flex-col">
<header class="flex items-center justify-between whitespace-nowrap border-b border-solid border-b-[var(--border)] px-10 py-3 bg-[var(--card)]">
<div class="flex items-center gap-8">
<div class="flex items-center gap-3 text-gray-900">
<svg class="h-8 w-8 text-[#4299f0]" fill="none" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
<path d="M4 4H17.3334V17.3334H30.6666V30.6666H44V44H4V4Z" fill="currentColor"></path>
</svg>
<h2 class="text-[var(--card-foreground)] text-xl font-bold leading-tight tracking-[-0.015em]">EduPath</h2>
</div>
<div class="flex items-center gap-6">
<a class="text-[var(--muted-foreground)] hover:text-[#4299f0] text-sm font-medium leading-normal" href="../landing_page_(homepage)_2/code.html">Home</a>
<a class="text-[var(--muted-foreground)] hover:text-[#4299f0] text-sm font-medium leading-normal" href="../aptitude_&_interest_quiz_page_2/code.html">Quiz</a>
<a class="text-[#4299f0] text-sm font-bold leading-normal" href="#">Colleges</a>
<a class="text-[var(--muted-foreground)] hover:text-[#4299f0] text-sm font-medium leading-normal" href="../course-to-career_path_mapping_2/code.html">Careers</a>
<a class="text-[var(--muted-foreground)] hover:text-[#4299f0] text-sm font-medium leading-normal" href="../study_material_&_resources_2/code.html">Resources</a>
</div>
</div>
<div class="flex items-center gap-4">
<button class="flex items-center justify-center rounded-full h-10 w-10 bg-[var(--secondary)] hover:bg-[var(--muted)] text-[var(--muted-foreground)]">
<span class="material-symbols-outlined text-2xl">
                    dark_mode
                </span>
</button>
<button class="flex items-center justify-center rounded-full h-10 w-10 bg-[var(--secondary)] hover:bg-[var(--muted)] text-[var(--muted-foreground)]">
<span class="material-symbols-outlined text-2xl">
              notifications
            </span>
</button>
<div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuDHULLTGgAB5uB4ieNyKekMDeonXsP7zXqCpF9RpHOXpaDnpBGiWbE33-UHaM5sLv3DBlb9E5XNmDHFxWqoexXVvsRW_8P79olmV772mYuneuXy5xdsfTMP3ZhLUSDXDMZh0LbZGlNEFUbZdU25kG112iVuXMDLw_W_U5ZuXq0TicjAntvSSo_qqRaIZyOWxvmOJYxeZT0qRsrTETd3Ua9w2YubF-rZA_vxOW--kKcB74kKYxJE-QCD9xEGfxE3xHL5kpel0z-Y_vPu");'></div>
</div>
</header>
<main class="flex-1 px-16 py-8">
<div class="max-w-7xl mx-auto">
<div class="mb-8">
<h1 class="text-[var(--foreground)] text-4xl font-bold leading-tight tracking-tight mb-2">Find Your Perfect College</h1>
<p class="text-[var(--muted-foreground)] text-lg">Discover colleges that match your aspirations and goals.</p>
</div>
<div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
<div class="lg:col-span-2">
<div class="mb-6">
<div class="relative">
<span class="material-symbols-outlined absolute left-4 top-1/2 -translate-y-1/2 text-[var(--muted-foreground)]">
                    search
                  </span>
<input id="locationInput" class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-xl text-[var(--foreground)] focus:outline-0 focus:ring-2 focus:ring-[#4299f0] border-[var(--border)] bg-[var(--card)] h-12 placeholder:text-[var(--muted-foreground)] pl-12 pr-4 text-base font-normal leading-normal" placeholder="Enter location (e.g., Jabalpur, Madhya Pradesh)" value=""/>
</div>
<div class="flex gap-4 mt-4">
<button id="searchBtn" class="inline-flex items-center justify-center rounded-lg h-10 px-5 bg-[var(--primary)] text-[var(--primary-foreground)] text-sm font-bold leading-normal tracking-wide shadow-sm hover:bg-blue-600 transition-colors">
  Search Colleges
</button>
<button id="liveLocationBtn" class="inline-flex items-center justify-center rounded-lg h-10 px-5 bg-green-600 text-white text-sm font-bold leading-normal tracking-wide shadow-sm hover:bg-green-700 transition-colors">
  Use Live Location
</button>
</div>
</div>
<div class="flex items-center justify-between mb-4">
<h2 class="text-[var(--foreground)] text-xl font-bold leading-tight">Colleges Near You</h2>
<div class="flex items-center gap-2">
<button class="text-[var(--muted-foreground)] hover:text-[var(--foreground)] text-sm font-medium">Sort by: Relevancy</button>
<span class="material-symbols-outlined text-lg text-[var(--muted-foreground)]">
                    expand_more
                  </span>
</div>
</div>
<div id="collegeResults" class="space-y-6">
<!-- College results will be populated here by JavaScript -->
<div class="text-center py-8">
<p class="text-[var(--muted-foreground)]">Enter a location and click "Search Colleges" to find nearby government colleges.</p>
</div>
</div>
<div class="flex items-center justify-center pt-8">
<nav class="flex items-center gap-2">
<a class="flex size-9 items-center justify-center rounded-lg text-[var(--muted-foreground)] hover:bg-[var(--secondary)]" href="#">
<span class="material-symbols-outlined text-xl">chevron_left</span>
</a>
<a class="text-sm font-bold leading-normal flex size-9 items-center justify-center text-white rounded-lg bg-[#4299f0]" href="#">1</a>
<a class="text-sm font-medium leading-normal flex size-9 items-center justify-center text-[var(--muted-foreground)] rounded-lg hover:bg-[var(--secondary)]" href="#">2</a>
<a class="text-sm font-medium leading-normal flex size-9 items-center justify-center text-[var(--muted-foreground)] rounded-lg hover:bg-[var(--secondary)]" href="#">3</a>
<span class="text-sm font-medium text-[var(--muted-foreground)]">...</span>
<a class="text-sm font-medium leading-normal flex size-9 items-center justify-center text-[var(--muted-foreground)] rounded-lg hover:bg-[var(--secondary)]" href="#">10</a>
<a class="flex size-9 items-center justify-center rounded-lg text-[var(--muted-foreground)] hover:bg-[var(--secondary)]" href="#">
<span class="material-symbols-outlined text-xl">chevron_right</span>
</a>
</nav>
</div>
</div>
<div class="lg:col-span-1">
<div class="sticky top-8">
<div id="mapContainer" class="w-full aspect-video rounded-2xl mb-6 shadow-md bg-gray-100 border border-gray-300 flex items-center justify-center">
  <div class="text-center text-gray-500">
    <div class="mb-2">
      <span class="material-symbols-outlined text-4xl">map</span>
    </div>
    <p>Interactive map will appear here after searching for colleges</p>
  </div>
</div>
<div class="bg-[var(--card)] p-6 rounded-2xl border border-[var(--border)] shadow-sm">
<h3 class="text-[var(--card-foreground)] text-lg font-bold mb-4">Filter Options</h3>
<div class="space-y-4">
<div>
<label class="block text-sm font-medium text-[var(--muted-foreground)] mb-1" for="radiusSelect">Search Radius (km)</label>
<select class="form-select w-full rounded-lg border-[var(--border)] bg-[var(--input)] text-[var(--foreground)] focus:ring-[#4299f0] focus:border-[#4299f0]" id="radiusSelect">
<option value="5">5 km</option>
<option value="10" selected>10 km</option>
<option value="15">15 km</option>
<option value="20">20 km</option>
<option value="30">30 km</option>
</select>
</div>
<div>
<label class="block text-sm font-medium text-[var(--muted-foreground)] mb-1" for="streamSelect">Stream</label>
<select class="form-select w-full rounded-lg border-[var(--border)] bg-[var(--input)] text-[var(--foreground)] focus:ring-[#4299f0] focus:border-[#4299f0]" id="streamSelect">
<option value="all">All Streams</option>
<option value="pcm">PCM (Engineering)</option>
<option value="pcb">PCB (Medical)</option>
<option value="arts">Arts</option>
<option value="commerce">Commerce</option>
</select>
</div>
<div>
<label class="block text-sm font-medium text-[var(--muted-foreground)] mb-1" for="cutoff">Cut-off Percentage</label>
<input class="w-full h-2 bg-[var(--muted)] rounded-lg appearance-none cursor-pointer accent-[#4299f0]" id="cutoff" max="100" min="0" type="range" value="75"/>
<div class="flex justify-between text-xs text-[var(--muted-foreground)] mt-1">
<span>0%</span>
<span>100%</span>
</div>
</div>
<div class="space-y-2">
<label class="block text-sm font-medium text-[var(--muted-foreground)]">Facilities</label>
<div class="flex items-center">
<input class="h-4 w-4 rounded border-[var(--border)] bg-[var(--input)] text-[#4299f0] focus:ring-[#4299f0]" id="hostel" type="checkbox"/>
<label class="ml-2 block text-sm text-[var(--foreground)]" for="hostel">Hostel</label>
</div>
<div class="flex items-center">
<input class="h-4 w-4 rounded border-[var(--border)] bg-[var(--input)] text-[#4299f0] focus:ring-[#4299f0]" id="lab" type="checkbox"/>
<label class="ml-2 block text-sm text-[var(--foreground)]" for="lab">Lab</label>
</div>
<div class="flex items-center">
<input class="h-4 w-4 rounded border-[var(--border)] bg-[var(--input)] text-[#4299f0] focus:ring-[#4299f0]" id="library" type="checkbox"/>
<label class="ml-2 block text-sm text-[var(--foreground)]" for="library">Library</label>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</main>
</div>
</div>

<script>
class CollegeSearchApp {
    constructor() {
        this.initializeEventListeners();
    }

    initializeEventListeners() {
        const searchBtn = document.getElementById('searchBtn');
        const liveLocationBtn = document.getElementById('liveLocationBtn');
        const locationInput = document.getElementById('locationInput');

        searchBtn.addEventListener('click', () => this.searchColleges());
        liveLocationBtn.addEventListener('click', () => this.searchWithLiveLocation());
        
        // Allow Enter key to trigger search
        locationInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                this.searchColleges();
            }
        });
    }

    showLoading() {
        document.getElementById('loadingOverlay').classList.remove('hidden');
    }

    hideLoading() {
        document.getElementById('loadingOverlay').classList.add('hidden');
    }

    async searchColleges() {
        const location = document.getElementById('locationInput').value.trim();
        if (!location) {
            alert('Please enter a location');
            return;
        }

        const radius = document.getElementById('radiusSelect').value;
        const stream = document.getElementById('streamSelect').value;

        this.performSearch({
            location: location,
            radius: parseInt(radius),
            stream: stream,
            use_live_location: false
        });
    }

    async searchWithLiveLocation() {
        const radius = document.getElementById('radiusSelect').value;
        const stream = document.getElementById('streamSelect').value;

        this.performSearch({
            radius: parseInt(radius),
            stream: stream,
            use_live_location: true
        });
    }

    async performSearch(searchData) {
        this.showLoading();
        
        try {
            const response = await fetch('/api/search', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(searchData)
            });

            const data = await response.json();
            
            if (data.success) {
                this.displayResults(data);
            } else {
                this.showError(data.error);
            }
        } catch (error) {
            this.showError('Failed to search colleges: ' + error.message);
        } finally {
            this.hideLoading();
        }
    }

    displayResults(data) {
        const resultsContainer = document.getElementById('collegeResults');
        const { colleges, location, map_file, total_found } = data;

        if (colleges.length === 0) {
            resultsContainer.innerHTML = `
                <div class="text-center py-8">
                    <p class="text-[var(--muted-foreground)]">No government colleges found near ${location.name}. Try increasing the search radius.</p>
                </div>
            `;
            return;
        }

        // Update the map container
        this.displayMap(data);
        
        let html = `
            <div class="mb-4 p-4 bg-green-100 border border-green-300 rounded-lg">
                <p class="text-green-800">Found ${total_found} government colleges near <strong>${location.name}</strong></p>
                <p class="text-sm text-green-600 mt-2">üìç Interactive map updated with college locations</p>
            </div>
        `;

        colleges.forEach((college, index) => {
            const collegeHtml = `
                <div class="flex items-start justify-between gap-6 rounded-2xl bg-[var(--card)] p-6 shadow-sm border border-[var(--border)] hover:shadow-lg transition-shadow duration-300">
                    <div class="flex-1">
                        <div class="flex items-center justify-between mb-3">
                            <h3 class="text-[var(--card-foreground)] text-lg font-bold leading-tight">${college.name}</h3>
                            <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded">${college.amenity.toUpperCase()}</span>
                        </div>
                        <div class="flex items-center gap-6 text-sm text-[var(--muted-foreground)] mb-4">
                            <div class="flex items-center gap-1.5">
                                <span class="material-symbols-outlined text-lg">business</span>
                                <span>${college.operator || 'Government'}</span>
                            </div>
                            <div class="flex items-center gap-1.5">
                                <span class="material-symbols-outlined text-lg">location_on</span>
                                <span>${college.lat.toFixed(4)}, ${college.lon.toFixed(4)}</span>
                            </div>
                        </div>
                        ${college.addr ? `<p class="text-[var(--muted-foreground)] text-sm mb-2"><strong>Address:</strong> ${college.addr}</p>` : ''}
                        ${college.phone ? `<p class="text-[var(--muted-foreground)] text-sm mb-2"><strong>Phone:</strong> ${college.phone}</p>` : ''}
                        ${college.website ? `<p class="text-[var(--muted-foreground)] text-sm mb-4"><strong>Website:</strong> <a href="${college.website}" target="_blank" class="text-blue-500 hover:underline">${college.website}</a></p>` : ''}
                        <div class="flex gap-2">
                            <button onclick="window.open('https://www.google.com/maps?q=${college.lat},${college.lon}', '_blank')" class="inline-flex items-center justify-center rounded-lg h-8 px-3 bg-[var(--primary)] text-[var(--primary-foreground)] text-xs font-medium hover:bg-blue-600 transition-colors">
                                View on Map
                            </button>
                            ${college.website ? `<button onclick="window.open('${college.website}', '_blank')" class="inline-flex items-center justify-center rounded-lg h-8 px-3 bg-green-600 text-white text-xs font-medium hover:bg-green-700 transition-colors">Visit Website</button>` : ''}
                        </div>
                    </div>
                </div>
            `;
            html += collegeHtml;
        });

        resultsContainer.innerHTML = html;
    }

    async displayMap(data) {
        const mapContainer = document.getElementById('mapContainer');
        const { colleges, location } = data;
        
        // Always use the embedded Leaflet map for better integration
        this.showSimpleMap(colleges, location);
    }
    
    showSimpleMap(colleges, location) {
        const mapContainer = document.getElementById('mapContainer');
        
        // Create the map container with proper styling
        const mapId = 'leafletMap';
        mapContainer.innerHTML = `
            <div id="${mapId}" class="w-full h-full rounded-2xl" style="min-height: 400px; height: 100%;"></div>
        `;
        
        // Load Leaflet if not already loaded
        if (typeof L === 'undefined') {
            const link = document.createElement('link');
            link.rel = 'stylesheet';
            link.href = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.css';
            document.head.appendChild(link);
            
            const script = document.createElement('script');
            script.src = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.js';
            script.onload = () => this.initLeafletMap(mapId, colleges, location);
            document.head.appendChild(script);
        } else {
            this.initLeafletMap(mapId, colleges, location);
        }
    }
    
    initLeafletMap(mapId, colleges, location) {
        // Clear any existing map
        const mapElement = document.getElementById(mapId);
        if (mapElement._leaflet_id) {
            mapElement._leaflet_id = null;
        }
        
        const map = L.map(mapId, {
            zoomControl: true,
            scrollWheelZoom: true,
            doubleClickZoom: true,
            boxZoom: true,
            keyboard: true
        }).setView([location.lat, location.lon], 12);
        
        // Add tile layer with better styling
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '¬© OpenStreetMap contributors',
            maxZoom: 18
        }).addTo(map);
        
        // Custom icon for user location
        const userIcon = L.divIcon({
            className: 'custom-user-marker',
            html: '<div style="background: #3b82f6; width: 20px; height: 20px; border-radius: 50%; border: 3px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);"></div>',
            iconSize: [20, 20],
            iconAnchor: [10, 10]
        });
        
        // Add user location marker
        L.marker([location.lat, location.lon], { icon: userIcon })
            .addTo(map)
            .bindPopup(`
                <div style="padding: 8px; min-width: 200px;">
                    <h3 style="margin: 0 0 8px 0; color: #1f2937; font-weight: bold;">üìç Your Location</h3>
                    <p style="margin: 0; color: #6b7280; font-size: 14px;">${location.name}</p>
                </div>
            `);
        
        // Custom icon for colleges
        const collegeIcon = L.divIcon({
            className: 'custom-college-marker',
            html: '<div style="background: #dc2626; width: 16px; height: 16px; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);"></div>',
            iconSize: [16, 16],
            iconAnchor: [8, 8]
        });
        
        // Add college markers with enhanced popups
        colleges.forEach((college, index) => {
            const marker = L.marker([college.lat, college.lon], { icon: collegeIcon })
                .addTo(map)
                .bindPopup(`
                    <div style="padding: 12px; min-width: 250px; max-width: 300px;">
                        <h3 style="margin: 0 0 8px 0; color: #1f2937; font-weight: bold; font-size: 16px; line-height: 1.2;">${college.name}</h3>
                        <p style="margin: 0 0 6px 0; color: #059669; font-size: 12px; font-weight: 600;">${college.operator || 'Government College'}</p>
                        ${college.addr ? `<p style="margin: 0 0 8px 0; color: #6b7280; font-size: 13px; line-height: 1.3;">${college.addr}</p>` : ''}
                        <div style="display: flex; gap: 6px; margin-top: 10px;">
                            <button onclick="window.open('https://www.google.com/maps?q=${college.lat},${college.lon}', '_blank')" 
                                    style="background: #3b82f6; color: white; border: none; padding: 6px 10px; border-radius: 4px; font-size: 11px; cursor: pointer; font-weight: 500;">
                                üìç View on Map
                            </button>
                            ${college.website ? `<button onclick="window.open('${college.website}', '_blank')" 
                                    style="background: #059669; color: white; border: none; padding: 6px 10px; border-radius: 4px; font-size: 11px; cursor: pointer; font-weight: 500;">
                                üåê Website
                            </button>` : ''}
                        </div>
                    </div>
                `);
        });
        
        // Add a circle to show search radius (optional)
        const radiusSelect = document.getElementById('radiusSelect');
        const radius = radiusSelect ? parseInt(radiusSelect.value) * 1000 : 10000;
        
        L.circle([location.lat, location.lon], {
            color: '#3b82f6',
            fillColor: '#3b82f6',
            fillOpacity: 0.1,
            radius: radius,
            weight: 2,
            dashArray: '5, 5'
        }).addTo(map);
        
        // Fit map to show all markers with padding
        if (colleges.length > 0) {
            const allMarkers = [...colleges.map(c => [c.lat, c.lon]), [location.lat, location.lon]];
            const group = new L.featureGroup(allMarkers.map(coords => L.marker(coords)));
            map.fitBounds(group.getBounds().pad(0.15));
        }
        
        // Force map to resize after a short delay
        setTimeout(() => {
            map.invalidateSize();
        }, 100);
    }

    showError(message) {
        const resultsContainer = document.getElementById('collegeResults');
        const mapContainer = document.getElementById('mapContainer');
        
        resultsContainer.innerHTML = `
            <div class="text-center py-8">
                <div class="bg-red-100 border border-red-300 rounded-lg p-4">
                    <p class="text-red-800">Error: ${message}</p>
                </div>
            </div>
        `;
        
        // Reset map container
        mapContainer.innerHTML = `
            <div class="text-center text-gray-500 p-4">
                <div class="mb-2">
                    <span class="material-symbols-outlined text-4xl">map</span>
                </div>
                <p>Interactive map will appear here after searching for colleges</p>
            </div>
        `;
    }
}

// Initialize the app when the page loads
document.addEventListener('DOMContentLoaded', () => {
    new CollegeSearchApp();
});
</script>
</body></html>